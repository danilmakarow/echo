{"ast":null,"code":"import { filter, tap } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"./chat-data.service\";\nimport * as i3 from \"@angular/material/icon\";\nimport * as i4 from \"@angular/material/button\";\nimport * as i5 from \"@angular/material/menu\";\nimport * as i6 from \"./message/message.component\";\nconst _c0 = [\"message\"];\nexport class ChatComponent {\n  //Закрытие компонента на escape\n  handleEscapeKey(event) {\n    this.router.navigateByUrl('');\n  }\n  //Отправка сообщения на ентер\n  handleEnterKey(event) {\n    this.chatData.onSendMessage(this.messageInput.nativeElement);\n  }\n  onKeyDown(event) {\n    if (event.key === 'Enter' && !event.shiftKey) {\n      event.preventDefault();\n    }\n  }\n  ngOnInit() {\n    //Подписки на изменения диалогов и сообщений\n    this.chatData.chatData$.pipe(filter(Boolean), tap(messages => this.user = messages)).subscribe();\n    this.chatData.messagesData$.pipe(filter(Boolean), tap(messages => this.messages = messages)).subscribe();\n  }\n  ngAfterViewChecked() {\n    this.messageInput.nativeElement.focus();\n  }\n  constructor(router, chatData) {\n    this.router = router;\n    this.chatData = chatData;\n    this.user = {\n      name: 'Loading',\n      photo: ''\n    };\n    this.messages = [];\n  }\n}\nChatComponent.ɵfac = function ChatComponent_Factory(t) {\n  return new (t || ChatComponent)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.ChatDataService));\n};\nChatComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: ChatComponent,\n  selectors: [[\"app-chat\"]],\n  viewQuery: function ChatComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(_c0, 5);\n    }\n    if (rf & 2) {\n      let _t;\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.messageInput = _t.first);\n    }\n  },\n  hostBindings: function ChatComponent_HostBindings(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵlistener(\"keydown.escape\", function ChatComponent_keydown_escape_HostBindingHandler($event) {\n        return ctx.handleEscapeKey($event);\n      }, false, i0.ɵɵresolveDocument)(\"keydown.enter\", function ChatComponent_keydown_enter_HostBindingHandler($event) {\n        return ctx.handleEnterKey($event);\n      }, false, i0.ɵɵresolveDocument);\n    }\n  },\n  decls: 27,\n  vars: 4,\n  consts: [[1, \"container\"], [1, \"header\", \"flex\"], [1, \"user\", \"flex\"], [1, \"avatar-box\"], [\"alt\", \"user's avatar\", 1, \"avatar\"], [1, \"username\"], [\"mat-icon-button\", \"\", \"color\", \"accent\", 3, \"matMenuTriggerFor\"], [\"menu\", \"matMenu\"], [\"mat-menu-item\", \"\"], [1, \"messenger-container\", \"flex\"], [1, \"main\"], [3, \"messages\"], [1, \"input-field\"], [1, \"input-container\"], [\"placeholder\", \"Message\", 1, \"input\", 3, \"input\", \"keydown\"], [\"message\", \"\"], [\"mat-icon-button\", \"\", \"color\", \"accent\", 1, \"btn-send\", 3, \"click\"], [1, \"menu-icon\"]],\n  template: function ChatComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      const _r2 = i0.ɵɵgetCurrentView();\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"header\", 1)(2, \"div\", 2)(3, \"div\", 3);\n      i0.ɵɵelement(4, \"img\", 4);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(5, \"div\", 5);\n      i0.ɵɵtext(6);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(7, \"button\", 6)(8, \"mat-icon\");\n      i0.ɵɵtext(9, \"more_vert\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(10, \"mat-menu\", null, 7)(12, \"button\", 8)(13, \"mat-icon\");\n      i0.ɵɵtext(14, \"delete\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(15, \"span\");\n      i0.ɵɵtext(16, \"Delete chat\");\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵelementStart(17, \"div\", 9)(18, \"main\", 10);\n      i0.ɵɵelement(19, \"app-message\", 11);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(20, \"div\", 12)(21, \"div\", 13)(22, \"textarea\", 14, 15);\n      i0.ɵɵlistener(\"input\", function ChatComponent_Template_textarea_input_22_listener() {\n        i0.ɵɵrestoreView(_r2);\n        const _r1 = i0.ɵɵreference(23);\n        return i0.ɵɵresetView(ctx.chatData.messageHeightCalc(_r1));\n      })(\"keydown\", function ChatComponent_Template_textarea_keydown_22_listener($event) {\n        return ctx.onKeyDown($event);\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(24, \"button\", 16);\n      i0.ɵɵlistener(\"click\", function ChatComponent_Template_button_click_24_listener() {\n        i0.ɵɵrestoreView(_r2);\n        const _r1 = i0.ɵɵreference(23);\n        return i0.ɵɵresetView(ctx.chatData.onSendMessage(_r1));\n      });\n      i0.ɵɵelementStart(25, \"mat-icon\", 17);\n      i0.ɵɵtext(26, \"send\");\n      i0.ɵɵelementEnd()()()()()();\n    }\n    if (rf & 2) {\n      const _r0 = i0.ɵɵreference(11);\n      i0.ɵɵadvance(4);\n      i0.ɵɵattribute(\"src\", ctx.user.photo, i0.ɵɵsanitizeUrl);\n      i0.ɵɵadvance(2);\n      i0.ɵɵtextInterpolate(ctx.user.name);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"matMenuTriggerFor\", _r0);\n      i0.ɵɵadvance(12);\n      i0.ɵɵproperty(\"messages\", ctx.messages);\n    }\n  },\n  dependencies: [i3.MatIcon, i4.MatIconButton, i5.MatMenu, i5.MatMenuItem, i5.MatMenuTrigger, i6.MessageComponent],\n  styles: [\"@charset \\\"UTF-8\\\";\\n.container[_ngcontent-%COMP%] {\\n  height: 100%;\\n}\\n\\n.header[_ngcontent-%COMP%] {\\n  padding: 0.9rem 2rem;\\n  justify-content: space-between;\\n  background-color: #1f1f21;\\n  box-shadow: 0 2px 2px rgba(0, 0, 0, 0.25098);\\n}\\n\\n.user[_ngcontent-%COMP%] {\\n  height: 100%;\\n  align-items: center;\\n  gap: 0.7rem;\\n  width: max-content;\\n}\\n\\n.avatar-box[_ngcontent-%COMP%] {\\n  width: 5rem;\\n  height: 5rem;\\n}\\n\\n.avatar[_ngcontent-%COMP%] {\\n  height: 100%;\\n  width: 100%;\\n  object-fit: cover;\\n  object-position: center;\\n  border-radius: 50%;\\n}\\n\\n.username[_ngcontent-%COMP%] {\\n  font-size: 1.6rem;\\n  color: #d0d0d0;\\n  font-weight: 600;\\n}\\n\\n.main[_ngcontent-%COMP%] {\\n  overflow-y: auto;\\n  overflow-x: hidden;\\n  height: calc(100% - 6rem);\\n  margin-bottom: 1rem;\\n}\\n\\n.messenger-container[_ngcontent-%COMP%] {\\n  height: calc(100% - 6.8rem);\\n  flex-direction: column;\\n  align-content: flex-start;\\n}\\n\\n\\n.input-field[_ngcontent-%COMP%] {\\n  width: 100%;\\n  margin-bottom: 1rem;\\n}\\n\\n.input-container[_ngcontent-%COMP%] {\\n  position: relative;\\n  max-width: 70rem;\\n  width: available;\\n  margin: 0 auto;\\n}\\n\\n.input[_ngcontent-%COMP%] {\\n  width: 100%;\\n  border-radius: 15px;\\n  padding: 1.6rem 5rem 1.6rem 3rem;\\n  border: none;\\n  background-color: #27272a;\\n  height: 54px;\\n  font-size: 1.8rem;\\n  color: #fff;\\n  resize: none;\\n}\\n.input[_ngcontent-%COMP%]:focus {\\n  outline: none;\\n}\\n\\n.btn-send[_ngcontent-%COMP%] {\\n  position: absolute;\\n  right: 5px;\\n  top: 2px;\\n}\\n\\n\\n[_ngcontent-%COMP%]::-webkit-scrollbar {\\n  width: 8px;\\n  background-color: transparent;\\n}\\n\\n[_ngcontent-%COMP%]::-webkit-scrollbar-thumb {\\n  background-color: rgba(128, 128, 128, 0.3);\\n  border-radius: 4px;\\n}\\n\\n\\n*[_ngcontent-%COMP%] {\\n  scrollbar-width: thin;\\n  scrollbar-color: rgba(128, 128, 128, 0.3) transparent;\\n}\\n\\n*[_ngcontent-%COMP%]::-webkit-scrollbar-thumb {\\n  border-radius: 4px;\\n}\\n\\n*[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:vertical {\\n  height: 30%;\\n}\\n\\n*[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:horizontal {\\n  width: 30%;\\n}\\n\\n*[_ngcontent-%COMP%]::-webkit-scrollbar-thumb {\\n  background-color: rgba(128, 128, 128, 0.3);\\n  border-radius: 4px;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvZmVhdHVyZS9tZXNzZW5nZXIvbWVzc2VuZ2VyL2NoYXQvY2hhdC5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxnQkFBZ0I7QUFBaEI7RUFDRSxZQUFBO0FBRUY7O0FBT0E7RUFFRSxvQkFBQTtFQUNBLDhCQUFBO0VBQ0EseUJBQUE7RUFDQSw0Q0FBQTtBQUxGOztBQVFBO0VBQ0UsWUFBQTtFQUNBLG1CQUFBO0VBQ0EsV0FBQTtFQUNBLGtCQUFBO0FBTEY7O0FBUUE7RUFDRSxXQUFBO0VBQ0EsWUFBQTtBQUxGOztBQVFBO0VBQ0UsWUFBQTtFQUNBLFdBQUE7RUFFQSxpQkFBQTtFQUNBLHVCQUFBO0VBQ0Esa0JBQUE7QUFORjs7QUFTQTtFQUNFLGlCQUFBO0VBQ0EsY0FBQTtFQUNBLGdCQUFBO0FBTkY7O0FBV0E7RUFDRSxnQkFBQTtFQUNBLGtCQUFBO0VBQ0EseUJBQUE7RUFDQSxtQkFBQTtBQVJGOztBQVdBO0VBQ0UsMkJBQUE7RUFDQSxzQkFBQTtFQUNBLHlCQUFBO0FBUkY7O0FBV0EsUUFBQTtBQUNBO0VBQ0UsV0FBQTtFQUNBLG1CQUFBO0FBUkY7O0FBV0E7RUFDRSxrQkFBQTtFQUNBLGdCQUFBO0VBQ0EsZ0JBQUE7RUFFQSxjQUFBO0FBVEY7O0FBWUE7RUFDRSxXQUFBO0VBQ0EsbUJBQUE7RUFDQSxnQ0FBQTtFQUNBLFlBQUE7RUFDQSx5QkFBQTtFQUNBLFlBQUE7RUFFQSxpQkFBQTtFQUNBLFdBQUE7RUFFQSxZQUFBO0FBWEY7QUFhRTtFQUNFLGFBQUE7QUFYSjs7QUFlQTtFQUNFLGtCQUFBO0VBQ0EsVUFBQTtFQUNBLFFBQUE7QUFaRjs7QUFpQkEsZUFBQTtBQUNBO0VBQ0UsVUFBQTtFQUNBLDZCQUFBO0FBZEY7O0FBaUJBO0VBQ0UsMENBQUE7RUFDQSxrQkFBQTtBQWRGOztBQWlCQSxnQkFBQTtBQUNBO0VBQ0UscUJBQUE7RUFDQSxxREFBQTtBQWRGOztBQWlCQTtFQUNFLGtCQUFBO0FBZEY7O0FBaUJBO0VBQ0UsV0FBQTtBQWRGOztBQWlCQTtFQUNFLFVBQUE7QUFkRjs7QUFpQkE7RUFDRSwwQ0FBQTtFQUNBLGtCQUFBO0FBZEYiLCJzb3VyY2VzQ29udGVudCI6WyIuY29udGFpbmVyIHtcclxuICBoZWlnaHQ6IDEwMCU7XHJcblxyXG4gIC8vcG9zaXRpb246IHJlbGF0aXZlO1xyXG4gIC8vZGlzcGxheTogZmxleDtcclxuICAvL2ZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XHJcbn1cclxuXHJcbi8vIEhFQURFUiAvL1xyXG5cclxuLmhlYWRlciB7XHJcbiAgLy9oZWlnaHQ6IDYuOHJlbTtcclxuICBwYWRkaW5nOiAwLjlyZW0gMnJlbTtcclxuICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XHJcbiAgYmFja2dyb3VuZC1jb2xvcjogIzFmMWYyMTtcclxuICBib3gtc2hhZG93OiAwIDJweCAycHggcmdiYSgwLDAsMCwwLjI1MDk4KTtcclxufVxyXG5cclxuLnVzZXIge1xyXG4gIGhlaWdodDogMTAwJTtcclxuICBhbGlnbi1pdGVtczogY2VudGVyO1xyXG4gIGdhcDogMC43cmVtO1xyXG4gIHdpZHRoOiBtYXgtY29udGVudDtcclxufVxyXG5cclxuLmF2YXRhci1ib3h7XHJcbiAgd2lkdGg6IDVyZW07XHJcbiAgaGVpZ2h0OiA1cmVtO1xyXG59XHJcblxyXG4uYXZhdGFyIHtcclxuICBoZWlnaHQ6IDEwMCU7XHJcbiAgd2lkdGg6IDEwMCU7XHJcblxyXG4gIG9iamVjdC1maXQ6IGNvdmVyO1xyXG4gIG9iamVjdC1wb3NpdGlvbjogY2VudGVyO1xyXG4gIGJvcmRlci1yYWRpdXM6IDUwJTtcclxufVxyXG5cclxuLnVzZXJuYW1lIHtcclxuICBmb250LXNpemU6IDEuNnJlbTtcclxuICBjb2xvcjogI2QwZDBkMDtcclxuICBmb250LXdlaWdodDogNjAwO1xyXG59XHJcblxyXG4vLyBDSEFUIC8vXHJcblxyXG4ubWFpbiB7XHJcbiAgb3ZlcmZsb3cteTogYXV0bztcclxuICBvdmVyZmxvdy14OiBoaWRkZW47XHJcbiAgaGVpZ2h0OiBjYWxjKDEwMCUgLSA2cmVtKTtcclxuICBtYXJnaW4tYm90dG9tOiAxcmVtO1xyXG59XHJcblxyXG4ubWVzc2VuZ2VyLWNvbnRhaW5lciB7XHJcbiAgaGVpZ2h0OiBjYWxjKDEwMCUgLSA2LjhyZW0pO1xyXG4gIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XHJcbiAgYWxpZ24tY29udGVudDogZmxleC1zdGFydDtcclxufVxyXG5cclxuLypJTlBVVCovXHJcbi5pbnB1dC1maWVsZCB7XHJcbiAgd2lkdGg6IDEwMCU7XHJcbiAgbWFyZ2luLWJvdHRvbTogMXJlbTtcclxufVxyXG5cclxuLmlucHV0LWNvbnRhaW5lciB7XHJcbiAgcG9zaXRpb246IHJlbGF0aXZlO1xyXG4gIG1heC13aWR0aDogNzByZW07XHJcbiAgd2lkdGg6IGF2YWlsYWJsZTtcclxuICAvL2hlaWdodDogNnJlbTtcclxuICBtYXJnaW46IDAgYXV0bztcclxufVxyXG5cclxuLmlucHV0IHtcclxuICB3aWR0aDogMTAwJTtcclxuICBib3JkZXItcmFkaXVzOiAxNXB4O1xyXG4gIHBhZGRpbmc6IDEuNnJlbSA1cmVtIDEuNnJlbSAzcmVtO1xyXG4gIGJvcmRlcjogbm9uZTtcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjMjcyNzJhO1xyXG4gIGhlaWdodDogNTRweDtcclxuXHJcbiAgZm9udC1zaXplOiAxLjhyZW07XHJcbiAgY29sb3I6ICNmZmY7XHJcblxyXG4gIHJlc2l6ZTogbm9uZTtcclxuXHJcbiAgJjpmb2N1cyB7XHJcbiAgICBvdXRsaW5lOiBub25lO1xyXG4gIH1cclxufVxyXG5cclxuLmJ0bi1zZW5kIHtcclxuICBwb3NpdGlvbjogYWJzb2x1dGU7XHJcbiAgcmlnaHQ6IDVweDtcclxuICB0b3A6IDJweDtcclxufVxyXG5cclxuLy9TQ1JPTExCQVJcclxuXHJcbi8qIMOQwpTDkMK7w5HCjyBXZWJLaXQgKi9cclxuOjotd2Via2l0LXNjcm9sbGJhciB7XHJcbiAgd2lkdGg6IDhweDtcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDtcclxufVxyXG5cclxuOjotd2Via2l0LXNjcm9sbGJhci10aHVtYiB7XHJcbiAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgxMjgsIDEyOCwgMTI4LCAwLjMpO1xyXG4gIGJvcmRlci1yYWRpdXM6IDRweDtcclxufVxyXG5cclxuLyogw5DClMOQwrvDkcKPIEZpcmVmb3ggKi9cclxuKiB7XHJcbiAgc2Nyb2xsYmFyLXdpZHRoOiB0aGluO1xyXG4gIHNjcm9sbGJhci1jb2xvcjogcmdiYSgxMjgsIDEyOCwgMTI4LCAwLjMpIHRyYW5zcGFyZW50O1xyXG59XHJcblxyXG4qOjotd2Via2l0LXNjcm9sbGJhci10aHVtYiB7XHJcbiAgYm9yZGVyLXJhZGl1czogNHB4O1xyXG59XHJcblxyXG4qOjotd2Via2l0LXNjcm9sbGJhci10aHVtYjp2ZXJ0aWNhbCB7XHJcbiAgaGVpZ2h0OiAzMCU7XHJcbn1cclxuXHJcbio6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iOmhvcml6b250YWwge1xyXG4gIHdpZHRoOiAzMCU7XHJcbn1cclxuXHJcbio6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iIHtcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDEyOCwgMTI4LCAxMjgsIDAuMyk7XHJcbiAgYm9yZGVyLXJhZGl1czogNHB4O1xyXG59XHJcbiJdLCJzb3VyY2VSb290IjoiIn0= */\"]\n});","map":{"version":3,"mappings":"AAYA,SAAQA,MAAM,EAAEC,GAAG,QAAO,MAAM;;;;;;;;;AAShC,OAAM,MAAOC,aAAa;EAGxB;EAEAC,eAAe,CAACC,KAAoB;IAClC,IAAI,CAACC,MAAM,CAACC,aAAa,CAAC,EAAE,CAAC;EAC/B;EAEA;EAEAC,cAAc,CAACH,KAAoB;IACjC,IAAI,CAACI,QAAQ,CAACC,aAAa,CAAC,IAAI,CAACC,YAAY,CAACC,aAAa,CAAC;EAC9D;EAEAC,SAAS,CAACR,KAAoB;IAC5B,IAAIA,KAAK,CAACS,GAAG,KAAK,OAAO,IAAI,CAACT,KAAK,CAACU,QAAQ,EAAE;MAC5CV,KAAK,CAACW,cAAc,EAAE;;EAE1B;EAQAC,QAAQ;IACN;IACA,IAAI,CAACR,QAAQ,CAACS,SAAS,CAACC,IAAI,CAC1BlB,MAAM,CAACmB,OAAO,CAAC,EACflB,GAAG,CAACmB,QAAQ,IAAI,IAAI,CAACC,IAAI,GAAGD,QAAQ,CAAC,CACtC,CAACE,SAAS,EAAE;IAEb,IAAI,CAACd,QAAQ,CAACe,aAAa,CAACL,IAAI,CAC9BlB,MAAM,CAACmB,OAAO,CAAC,EACflB,GAAG,CAACmB,QAAQ,IAAI,IAAI,CAACA,QAAQ,GAAGA,QAAQ,CAAC,CAC1C,CAACE,SAAS,EAAE;EACf;EAEAE,kBAAkB;IAChB,IAAI,CAACd,YAAY,CAACC,aAAa,CAACc,KAAK,EAAE;EACzC;EAEAC,YACUrB,MAAc,EACfG,QAAyB;IADxB,WAAM,GAANH,MAAM;IACP,aAAQ,GAARG,QAAQ;IAzBjB,SAAI,GAAS;MACXmB,IAAI,EAAE,SAAS;MACfC,KAAK,EAAE;KACR;IACD,aAAQ,GAAc,EAAE;EAsBrB;;AA/CQ1B,aAAa;mBAAbA,aAAa;AAAA;AAAbA,aAAa;QAAbA,aAAa;EAAA2B;EAAAC;IAAA;;;;;;;;;;;eAAbC,2BAAuB;MAAA;QAAA,OAAvBA,0BAAsB;MAAA;;;;;;;;;MCrBnCC,8BAAuB;MAIfA,yBAAgE;MAClEA,iBAAM;MACNA,8BAAsB;MAAAA,YAAa;MAAAA,iBAAM;MAE3CA,iCAAkE;MACtDA,yBAAS;MAAAA,iBAAW;MAEhCA,0CAA0B;MAEZA,uBAAM;MAAAA,iBAAW;MAC3BA,6BAAM;MAAAA,4BAAW;MAAAA,iBAAO;MAI9BA,+BAAsC;MAElCA,mCACc;MAChBA,iBAAO;MACPA,gCAAyB;MAIkCA;QAAAA;QAAA;QAAA,OAASA,kDAAwC;MAAA,EAAC;QAAA,OAAYD,qBAAiB;MAAA,EAA7B;MAA+BC,iBAAW;MACnJA,mCAAuG;MAA/CA;QAAAA;QAAA;QAAA,OAASA,8CAAoC;MAAA,EAAC;MACpGA,qCAA4B;MAAAA,qBAAI;MAAAA,iBAAW;;;;MAzBzBA,eAAuB;MAAvBA,uDAAuB;MAEvBA,eAAa;MAAbA,mCAAa;MAEbA,eAA0B;MAA1BA,uCAA0B;MAYnCA,gBAAqB;MAArBA,uCAAqB","names":["filter","tap","ChatComponent","handleEscapeKey","event","router","navigateByUrl","handleEnterKey","chatData","onSendMessage","messageInput","nativeElement","onKeyDown","key","shiftKey","preventDefault","ngOnInit","chatData$","pipe","Boolean","messages","user","subscribe","messagesData$","ngAfterViewChecked","focus","constructor","name","photo","selectors","viewQuery","ctx","i0"],"sourceRoot":"","sources":["C:\\Courses\\ANGULAR\\echo\\src\\app\\feature\\messenger\\messenger\\chat\\chat.component.ts","C:\\Courses\\ANGULAR\\echo\\src\\app\\feature\\messenger\\messenger\\chat\\chat.component.html"],"sourcesContent":["import {\n  AfterViewChecked,\n  AfterViewInit,\n  Component,\n  ElementRef,\n  HostListener,\n  OnDestroy,\n  OnInit,\n  ViewChild\n} from '@angular/core';\nimport {chat, message, User} from \"../../../user-data.service\";\nimport {Router} from \"@angular/router\";\nimport {filter, tap} from 'rxjs';\nimport {ChatDataService} from \"./chat-data.service\";\n\n@Component({\n  selector: 'app-chat',\n  templateUrl: './chat.component.html',\n  styleUrls: ['./chat.component.scss']\n})\n\nexport class ChatComponent implements OnInit, AfterViewChecked {\n  @ViewChild('message', {static: false}) messageInput!: ElementRef;\n\n  //Закрытие компонента на escape\n  @HostListener('document:keydown.escape', ['$event'])\n  handleEscapeKey(event: KeyboardEvent): void {\n    this.router.navigateByUrl('')\n  };\n\n  //Отправка сообщения на ентер\n  @HostListener('document:keydown.enter', ['$event'])\n  handleEnterKey(event: KeyboardEvent): void {\n    this.chatData.onSendMessage(this.messageInput.nativeElement)\n  }\n\n  onKeyDown(event: KeyboardEvent): void {\n    if (event.key === 'Enter' && !event.shiftKey) {\n      event.preventDefault();\n    }\n  }\n\n  user: User = {\n    name: 'Loading',\n    photo: ''\n  };\n  messages: message[] = [];\n\n  ngOnInit() {\n    //Подписки на изменения диалогов и сообщений\n    this.chatData.chatData$.pipe(\n      filter(Boolean),\n      tap(messages => this.user = messages)\n    ).subscribe();\n\n    this.chatData.messagesData$.pipe(\n      filter(Boolean),\n      tap(messages => this.messages = messages)\n    ).subscribe();\n  }\n\n  ngAfterViewChecked() {\n    this.messageInput.nativeElement.focus();\n  }\n\n  constructor(\n    private router: Router,\n    public chatData: ChatDataService\n  ) {}\n}\n","<div class=\"container\">\n  <header class=\"header flex\">\n    <div class=\"user flex\">\n      <div class=\"avatar-box\">\n        <img class=\"avatar\" [attr.src]=\"user.photo\" alt=\"user's avatar\">\n      </div>\n      <div class=\"username\">{{user.name}}</div>\n    </div>\n    <button mat-icon-button [matMenuTriggerFor]=\"menu\" color=\"accent\">\n      <mat-icon>more_vert</mat-icon>\n    </button>\n    <mat-menu #menu=\"matMenu\">\n      <button mat-menu-item>\n        <mat-icon>delete</mat-icon>\n        <span>Delete chat</span>\n      </button>\n    </mat-menu>\n  </header>\n  <div class=\"messenger-container flex\">\n    <main class=\"main\">\n      <app-message [messages]=\"messages\">\n      </app-message>\n    </main>\n    <div class=\"input-field\">\n      <div class=\"input-container\">\n<!--        <input type=\"text\" class=\"input\" placeholder=\"Message\" #message>-->\n<!--        <div role=\"textbox\" class=\"input\" placeholder=\"Message\" #message>-->\n        <textarea class=\"input\" #message placeholder=\"Message\" (input)=\"this.chatData.messageHeightCalc(message)\" (keydown)=\"onKeyDown($event)\"></textarea>\n        <button mat-icon-button color=\"accent\" class=\"btn-send\" (click)=\"this.chatData.onSendMessage(message)\">\n          <mat-icon class=\"menu-icon\">send</mat-icon>\n        </button>\n      </div>\n    </div>\n  </div>\n</div>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}