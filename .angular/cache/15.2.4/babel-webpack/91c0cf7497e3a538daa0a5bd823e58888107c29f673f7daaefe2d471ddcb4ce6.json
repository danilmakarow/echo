{"ast":null,"code":"import { filter, tap } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"./chat-data.service\";\nimport * as i3 from \"@angular/material/icon\";\nimport * as i4 from \"@angular/material/button\";\nimport * as i5 from \"@angular/material/menu\";\nimport * as i6 from \"./message/message.component\";\nconst _c0 = [\"message\"];\nexport class ChatComponent {\n  handleEscapeKey(event) {\n    this.router.navigateByUrl(''); //Close component on Escape\n  }\n\n  handleEnterKey(event) {\n    this.chatData.onSendMessage(this.messageInput.nativeElement); //Send message on Enter\n  }\n\n  constructor(router, chatData) {\n    this.router = router;\n    this.chatData = chatData;\n    this.user = {\n      name: 'Loading',\n      photo: ''\n    };\n    this.messages = [];\n  }\n  ngOnInit() {\n    //Subscriptions on changes in messages and dialogs\n    this.chatData.chatData$.pipe(filter(Boolean), tap(messages => this.user = messages)).subscribe();\n    this.chatData.messagesData$.pipe(filter(Boolean), tap(messages => this.messages = messages)).subscribe();\n  }\n  ngAfterViewChecked() {\n    this.messageInput.nativeElement.focus();\n  }\n  onKeyDown(event) {\n    if (event.key === 'Enter' && !event.shiftKey) event.preventDefault();\n  }\n}\nChatComponent.ɵfac = function ChatComponent_Factory(t) {\n  return new (t || ChatComponent)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.ChatDataService));\n};\nChatComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: ChatComponent,\n  selectors: [[\"app-chat\"]],\n  viewQuery: function ChatComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(_c0, 5);\n    }\n    if (rf & 2) {\n      let _t;\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.messageInput = _t.first);\n    }\n  },\n  hostBindings: function ChatComponent_HostBindings(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵlistener(\"keydown.escape\", function ChatComponent_keydown_escape_HostBindingHandler($event) {\n        return ctx.handleEscapeKey($event);\n      }, false, i0.ɵɵresolveDocument)(\"keydown.enter\", function ChatComponent_keydown_enter_HostBindingHandler($event) {\n        return ctx.handleEnterKey($event);\n      }, false, i0.ɵɵresolveDocument);\n    }\n  },\n  decls: 27,\n  vars: 4,\n  consts: [[1, \"container\"], [1, \"header\", \"flex\"], [1, \"user\", \"flex\"], [1, \"avatar-box\"], [\"alt\", \"user's avatar\", 1, \"avatar\"], [1, \"username\"], [\"mat-icon-button\", \"\", \"color\", \"accent\", 3, \"matMenuTriggerFor\"], [\"menu\", \"matMenu\"], [\"mat-menu-item\", \"\"], [1, \"messenger-container\", \"flex\"], [1, \"main\"], [3, \"messages\"], [1, \"input-field\"], [1, \"input-container\"], [\"placeholder\", \"Message\", 1, \"input\", 3, \"input\", \"keydown\"], [\"message\", \"\"], [\"mat-icon-button\", \"\", \"color\", \"accent\", 1, \"btn-send\", 3, \"click\"], [1, \"menu-icon\"]],\n  template: function ChatComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      const _r2 = i0.ɵɵgetCurrentView();\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"header\", 1)(2, \"div\", 2)(3, \"div\", 3);\n      i0.ɵɵelement(4, \"img\", 4);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(5, \"div\", 5);\n      i0.ɵɵtext(6);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(7, \"button\", 6)(8, \"mat-icon\");\n      i0.ɵɵtext(9, \"more_vert\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(10, \"mat-menu\", null, 7)(12, \"button\", 8)(13, \"mat-icon\");\n      i0.ɵɵtext(14, \"delete\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(15, \"span\");\n      i0.ɵɵtext(16, \"Delete chat\");\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵelementStart(17, \"div\", 9)(18, \"main\", 10);\n      i0.ɵɵelement(19, \"app-message\", 11);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(20, \"div\", 12)(21, \"div\", 13)(22, \"textarea\", 14, 15);\n      i0.ɵɵlistener(\"input\", function ChatComponent_Template_textarea_input_22_listener() {\n        i0.ɵɵrestoreView(_r2);\n        const _r1 = i0.ɵɵreference(23);\n        return i0.ɵɵresetView(ctx.chatData.messageHeightCalc(_r1));\n      })(\"keydown\", function ChatComponent_Template_textarea_keydown_22_listener($event) {\n        return ctx.onKeyDown($event);\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(24, \"button\", 16);\n      i0.ɵɵlistener(\"click\", function ChatComponent_Template_button_click_24_listener() {\n        i0.ɵɵrestoreView(_r2);\n        const _r1 = i0.ɵɵreference(23);\n        return i0.ɵɵresetView(ctx.chatData.onSendMessage(_r1));\n      });\n      i0.ɵɵelementStart(25, \"mat-icon\", 17);\n      i0.ɵɵtext(26, \"send\");\n      i0.ɵɵelementEnd()()()()()();\n    }\n    if (rf & 2) {\n      const _r0 = i0.ɵɵreference(11);\n      i0.ɵɵadvance(4);\n      i0.ɵɵattribute(\"src\", ctx.user.photo, i0.ɵɵsanitizeUrl);\n      i0.ɵɵadvance(2);\n      i0.ɵɵtextInterpolate(ctx.user.name);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"matMenuTriggerFor\", _r0);\n      i0.ɵɵadvance(12);\n      i0.ɵɵproperty(\"messages\", ctx.messages);\n    }\n  },\n  dependencies: [i3.MatIcon, i4.MatIconButton, i5.MatMenu, i5.MatMenuItem, i5.MatMenuTrigger, i6.MessageComponent],\n  styles: [\"@charset \\\"UTF-8\\\";.container[_ngcontent-%COMP%]{height:100%}.header[_ngcontent-%COMP%]{padding:.9rem 2rem;justify-content:space-between;background-color:#1f1f21;box-shadow:0 2px 2px #00000040}.user[_ngcontent-%COMP%]{height:100%;align-items:center;gap:.7rem;width:max-content}.avatar-box[_ngcontent-%COMP%]{width:5rem;height:5rem}.avatar[_ngcontent-%COMP%]{height:100%;width:100%;object-fit:cover;object-position:center;border-radius:50%}.username[_ngcontent-%COMP%]{font-size:1.6rem;color:#d0d0d0;font-weight:600}.main[_ngcontent-%COMP%]{overflow-y:auto;overflow-x:hidden;height:calc(100% - 6rem);margin-bottom:1rem}.messenger-container[_ngcontent-%COMP%]{height:calc(100% - 6.8rem);flex-direction:column;align-content:flex-start}.input-field[_ngcontent-%COMP%]{width:100%;margin-bottom:1rem}.input-container[_ngcontent-%COMP%]{position:relative;max-width:70rem;width:available;margin:0 auto}.input[_ngcontent-%COMP%]{width:100%;border-radius:15px;padding:1.6rem 5rem 1.6rem 3rem;border:none;background-color:#27272a;height:54px;font-size:1.8rem;color:#fff;resize:none}.input[_ngcontent-%COMP%]:focus{outline:none}.btn-send[_ngcontent-%COMP%]{position:absolute;right:5px;top:2px}[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px;background-color:transparent}[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#8080804d;border-radius:4px}*[_ngcontent-%COMP%]{scrollbar-width:thin;scrollbar-color:rgba(128,128,128,.3) transparent}*[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{border-radius:4px}*[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:vertical{height:30%}*[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:horizontal{width:30%}*[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#8080804d;border-radius:4px}\"]\n});","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}